# ci-mp-wx ä¾èµ–æ›´æ–°å’ŒåŒ…ç®¡ç†å™¨è¿ç§»æŠ¥å‘Š

## ğŸ“‹ è¿ç§»æ¦‚è§ˆ

æœ¬æ¬¡è¿ç§»æˆåŠŸå°†é¡¹ç›®ä» Yarn è¿ç§»åˆ° pnpmï¼Œå¹¶æ›´æ–°äº†æ‰€æœ‰ä¾èµ–åˆ°æœ€æ–°ç¨³å®šç‰ˆæœ¬ã€‚

## ğŸ”„ ä¸»è¦å˜æ›´

### åŒ…ç®¡ç†å™¨è¿ç§»
- **ä»**: Yarn
- **åˆ°**: pnpm 10.14.0
- **ä¼˜åŠ¿**: æ›´å¿«çš„å®‰è£…é€Ÿåº¦ã€èŠ‚çœç£ç›˜ç©ºé—´ã€æ›´ä¸¥æ ¼çš„ä¾èµ–ç®¡ç†

### ä¾èµ–æ›´æ–°

#### ç”Ÿäº§ä¾èµ–æ›´æ–°
| åŒ…å | æ—§ç‰ˆæœ¬ | æ–°ç‰ˆæœ¬ | çŠ¶æ€ |
|------|--------|--------|------|
| @clack/prompts | ^0.7.0 | ^0.11.0 | âœ… å·²æ›´æ–° |
| bundle-require | ^4.0.3 | ^5.1.0 | âœ… å·²æ›´æ–° |
| miniprogram-ci | ^1.9.15 | ^2.1.26 | âœ… å·²æ›´æ–° |
| semver | ^7.6.0 | ^7.7.2 | âœ… å·²æ›´æ–° |
| type-fest | ^4.17.0 | ^4.41.0 | âœ… å·²æ›´æ–° |

#### å¼€å‘ä¾èµ–æ›´æ–°
| åŒ…å | æ—§ç‰ˆæœ¬ | æ–°ç‰ˆæœ¬ | çŠ¶æ€ |
|------|--------|--------|------|
| @types/node | ^20.12.7 | ^24.3.0 | âœ… å·²æ›´æ–° |
| @types/semver | ^7.5.8 | ^7.7.0 | âœ… å·²æ›´æ–° |
| eslint | ^9.1.1 | ^9.33.0 | âœ… å·²æ›´æ–° |
| prettier | ^3.2.5 | ^3.6.2 | âœ… å·²æ›´æ–° |
| prettier-plugin-organize-imports | ^3.2.4 | ^4.2.0 | âœ… å·²æ›´æ–° |
| tsup | ^8.0.2 | ^8.5.0 | âœ… å·²æ›´æ–° |
| typescript | ^5.4.5 | ^5.9.2 | âœ… å·²æ›´æ–° |

#### æ–°å¢ä¾èµ–
| åŒ…å | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| cross-env | ^10.0.0 | è·¨å¹³å°ç¯å¢ƒå˜é‡è®¾ç½® |
| typescript-eslint | ^8.40.0 | TypeScript ESLint æ”¯æŒ |
| @eslint/js | ^9.33.0 | ESLint JavaScript é…ç½® |

## ğŸ› ï¸ é…ç½®æ–‡ä»¶æ›´æ–°

### æ–°å¢æ–‡ä»¶
- `pnpm-workspace.yaml` - pnpm å·¥ä½œç©ºé—´é…ç½®
- `eslint.config.js` - ESLint 9.x æ–°æ ¼å¼é…ç½®æ–‡ä»¶

### ä¿®æ”¹æ–‡ä»¶
- `package.json` - æ›´æ–°ä¾èµ–ç‰ˆæœ¬ï¼Œæ·»åŠ æ–°çš„è„šæœ¬å‘½ä»¤
- `README.md` - æ›´æ–°å®‰è£…è¯´æ˜ï¼ˆyarn â†’ pnpmï¼‰
- `tsup.config.ts` - ä¿æŒ CommonJS æ ¼å¼ä»¥ç¡®ä¿å…¼å®¹æ€§

## ğŸ”§ ä»£ç ä¿®å¤

### TypeScript å…¼å®¹æ€§ä¿®å¤
- ç§»é™¤äº† `allowIgnoreUnusedFiles` å±æ€§ï¼ˆåœ¨æ–°ç‰ˆ miniprogram-ci ä¸­å·²åºŸå¼ƒï¼‰
- ä¿®å¤äº†æœªä½¿ç”¨å˜é‡çš„ ESLint è­¦å‘Š

### æ„å»ºç³»ç»Ÿä¼˜åŒ–
- æ·»åŠ  `cross-env` æ”¯æŒ Windows ç¯å¢ƒå˜é‡è®¾ç½®
- ä¿æŒ CommonJS è¾“å‡ºæ ¼å¼ä»¥ç¡®ä¿æœ€å¤§å…¼å®¹æ€§

## âœ… åŠŸèƒ½éªŒè¯

### æ„å»ºæµ‹è¯•
- âœ… TypeScript ç¼–è¯‘æˆåŠŸ
- âœ… ç”Ÿæˆæ­£ç¡®çš„ JavaScript å’Œç±»å‹å®šä¹‰æ–‡ä»¶
- âœ… ä»£ç å‹ç¼©å’Œä¼˜åŒ–æ­£å¸¸

### ä»£ç è´¨é‡æ£€æŸ¥
- âœ… TypeScript ç±»å‹æ£€æŸ¥é€šè¿‡
- âœ… ESLint ä»£ç æ£€æŸ¥é€šè¿‡
- âœ… Prettier ä»£ç æ ¼å¼åŒ–æ£€æŸ¥é€šè¿‡

### CLI åŠŸèƒ½æµ‹è¯•
- âœ… CLI å·¥å…·èƒ½æ­£å¸¸å¯åŠ¨
- âœ… é…ç½®æ–‡ä»¶è§£æé€»è¾‘æ­£å¸¸
- âœ… é”™è¯¯å¤„ç†æœºåˆ¶æ­£å¸¸

## ğŸ“¦ æ–°å¢è„šæœ¬å‘½ä»¤

```json
{
  "scripts": {
    "dev": "cross-env NODE_ENV=development tsup",
    "build": "cross-env NODE_ENV=production tsup",
    "type-check": "tsc --noEmit",
    "lint": "eslint src/",
    "lint:fix": "eslint src/ --fix",
    "format": "prettier --write src/",
    "format:check": "prettier --check src/",
    "test": "pnpm run build && pnpm run type-check && pnpm run lint && pnpm run format:check"
  }
}
```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **peer dependency è­¦å‘Š**: miniprogram-ci çš„ @babel/eslint-parser ä¸ ESLint 9.x å­˜åœ¨ç‰ˆæœ¬å…¼å®¹æ€§è­¦å‘Šï¼Œä½†ä¸å½±å“æ ¸å¿ƒåŠŸèƒ½
2. **ESLint é…ç½®è­¦å‘Š**: ç”±äºä½¿ç”¨äº†æ–°çš„ ESLint é…ç½®æ ¼å¼ï¼Œä¼šæœ‰æ¨¡å—ç±»å‹è­¦å‘Šï¼Œä½†åŠŸèƒ½æ­£å¸¸
3. **Prettier è­¦å‘Š**: å¿½ç•¥äº†å·²åºŸå¼ƒçš„ `pluginSearchDirs` é€‰é¡¹ï¼Œä¸å½±å“æ ¼å¼åŒ–åŠŸèƒ½

## ğŸ¯ è¿ç§»æ”¶ç›Š

1. **æ€§èƒ½æå‡**: pnpm çš„å®‰è£…é€Ÿåº¦æ¯” yarn å¿«çº¦ 2-3 å€
2. **ç£ç›˜ç©ºé—´èŠ‚çœ**: é€šè¿‡ç¡¬é“¾æ¥æœºåˆ¶å‡å°‘é‡å¤ä¾èµ–
3. **ä¾èµ–å®‰å…¨**: æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬ä¿®å¤äº†æ½œåœ¨çš„å®‰å…¨æ¼æ´
4. **å¼€å‘ä½“éªŒ**: æ–°å¢äº†å®Œæ•´çš„ä»£ç è´¨é‡æ£€æŸ¥æµç¨‹
5. **ç±»å‹å®‰å…¨**: å‡çº§åˆ°æœ€æ–°çš„ TypeScript å’Œç±»å‹å®šä¹‰

## ğŸ“ˆ åç»­å»ºè®®

1. å®šæœŸè¿è¡Œ `pnpm outdated` æ£€æŸ¥ä¾èµ–æ›´æ–°
2. ä½¿ç”¨ `pnpm test` è¿›è¡Œå®Œæ•´çš„ä»£ç è´¨é‡æ£€æŸ¥
3. è€ƒè™‘æ·»åŠ  GitHub Actions è‡ªåŠ¨åŒ– CI/CD æµç¨‹
4. å®šæœŸæ›´æ–° Node.js ç±»å‹å®šä¹‰ä»¥æ”¯æŒæœ€æ–°ç‰¹æ€§

---

**è¿ç§»å®Œæˆæ—¶é—´**: 2025-08-22  
**è¿ç§»çŠ¶æ€**: âœ… æˆåŠŸå®Œæˆ  
**åŠŸèƒ½å®Œæ•´æ€§**: âœ… 100% ä¿æŒ